running: {'--uuid': 'c524f73542ac5f13a0f28322494f641b', '-db-root': '/home/ryedida/smoothness-hpo/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/smoothness-hpo/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20240113_114336', '--opt': 'stcvx', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python stcvx/optimizer.py -c MLP-adam -d digits -o stcvx -u c524f73542ac5f13a0f28322494f641b -m nll -n 15 -p 1 -dir /home/ryedida/smoothness-hpo/bbo_challenge_starter_kit/output -b run_20240113_114336
/home/ryedida/.local/lib/python3.8/site-packages/sklearn/neural_network/_multilayer_perceptron.py:603: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.8/site-packages/sklearn/neural_network/_multilayer_perceptron.py:684: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.25190216699945595])
/home/ryedida/.local/lib/python3.8/site-packages/bayesmark/experiment.py:469: UserWarning: Baselines not found. Will not log intermediate scores.
  warnings.warn("Baselines not found. Will not log intermediate scores.")

starting sklearn study stcvx MLP-adam digits nll 15 1
with data root: None
suggestion time taken 30.134400 iter 0 next_points [{'alpha': 0.09150459292716123, 'batch_size': 14, 'beta_1': 0.9653942849798802, 'beta_2': 0.9917495097129364, 'epsilon': 2.877074621691644e-09, 'hidden_layer_sizes': 63, 'learning_rate_init': 0.05448416998130452, 'tol': 0.020628622150643573, 'validation_fraction': 0.20978280004016348}]
function_evaluation time 3.968355 value 0.929663 suggestion {'alpha': 0.09150459292716123, 'batch_size': 14, 'beta_1': 0.9653942849798802, 'beta_2': 0.9917495097129364, 'epsilon': 2.877074621691644e-09, 'hidden_layer_sizes': 63, 'learning_rate_init': 0.05448416998130452, 'tol': 0.020628622150643573, 'validation_fraction': 0.20978280004016348}
observation time 0.000003, current best 0.929663 at iter 0
suggestion time taken 30.079735 iter 1 next_points [{'alpha': 3.144381082440938e-05, 'batch_size': 13, 'beta_1': 0.946287553015297, 'beta_2': 0.979317341077626, 'epsilon': 5.8316442471548654e-08, 'hidden_layer_sizes': 85, 'learning_rate_init': 6.223294247726584e-05, 'tol': 0.0010314991473889174, 'validation_fraction': 0.729375936916369}]
function_evaluation time 16.986914 value 0.251183 suggestion {'alpha': 3.144381082440938e-05, 'batch_size': 13, 'beta_1': 0.946287553015297, 'beta_2': 0.979317341077626, 'epsilon': 5.8316442471548654e-08, 'hidden_layer_sizes': 85, 'learning_rate_init': 6.223294247726584e-05, 'tol': 0.0010314991473889174, 'validation_fraction': 0.729375936916369}
observation time 0.000021, current best 0.251183 at iter 1
suggestion time taken 30.860870 iter 2 next_points [{'alpha': 0.0021379799406104722, 'batch_size': 20, 'beta_1': 0.9650861012385753, 'beta_2': 0.9958210466063376, 'epsilon': 2.3080492058686036e-08, 'hidden_layer_sizes': 66, 'learning_rate_init': 1.6779524704435645e-05, 'tol': 0.0003476955202023402, 'validation_fraction': 0.5476322700812806}]
/home/ryedida/.local/lib/python3.8/site-packages/sklearn/neural_network/_multilayer_perceptron.py:684: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 15.897527 value 3.451872 suggestion {'alpha': 0.0021379799406104722, 'batch_size': 20, 'beta_1': 0.9650861012385753, 'beta_2': 0.9958210466063376, 'epsilon': 2.3080492058686036e-08, 'hidden_layer_sizes': 66, 'learning_rate_init': 1.6779524704435645e-05, 'tol': 0.0003476955202023402, 'validation_fraction': 0.5476322700812806}
observation time 0.000014, current best 0.251183 at iter 2
suggestion time taken 29.367710 iter 3 next_points [{'alpha': 3.8231150017839775, 'batch_size': 13, 'beta_1': 0.9445606327806325, 'beta_2': 0.9667169371719113, 'epsilon': 2.4194968973588126e-08, 'hidden_layer_sizes': 155, 'learning_rate_init': 0.013220125543962964, 'tol': 0.013759109709067557, 'validation_fraction': 0.6861799799261274}]
function_evaluation time 3.133881 value 0.375106 suggestion {'alpha': 3.8231150017839775, 'batch_size': 13, 'beta_1': 0.9445606327806325, 'beta_2': 0.9667169371719113, 'epsilon': 2.4194968973588126e-08, 'hidden_layer_sizes': 155, 'learning_rate_init': 0.013220125543962964, 'tol': 0.013759109709067557, 'validation_fraction': 0.6861799799261274}
observation time 0.000009, current best 0.251183 at iter 3
suggestion time taken 27.212324 iter 4 next_points [{'alpha': 0.20526951873447094, 'batch_size': 19, 'beta_1': 0.9867696584681808, 'beta_2': 0.9297716551423195, 'epsilon': 2.178614648057339e-08, 'hidden_layer_sizes': 144, 'learning_rate_init': 0.03395071719721403, 'tol': 0.00021023328005968577, 'validation_fraction': 0.2587180525926379}]
function_evaluation time 6.043288 value 1.440974 suggestion {'alpha': 0.20526951873447094, 'batch_size': 19, 'beta_1': 0.9867696584681808, 'beta_2': 0.9297716551423195, 'epsilon': 2.178614648057339e-08, 'hidden_layer_sizes': 144, 'learning_rate_init': 0.03395071719721403, 'tol': 0.00021023328005968577, 'validation_fraction': 0.2587180525926379}
observation time 0.000013, current best 0.251183 at iter 4
suggestion time taken 27.001560 iter 5 next_points [{'alpha': 0.008759169523318112, 'batch_size': 22, 'beta_1': 0.9200120847898379, 'beta_2': 0.9938018787169736, 'epsilon': 3.975254064025581e-07, 'hidden_layer_sizes': 157, 'learning_rate_init': 0.024209588203294035, 'tol': 5.0229244698023884e-05, 'validation_fraction': 0.25145775245110913}]
function_evaluation time 4.906028 value 0.243130 suggestion {'alpha': 0.008759169523318112, 'batch_size': 22, 'beta_1': 0.9200120847898379, 'beta_2': 0.9938018787169736, 'epsilon': 3.975254064025581e-07, 'hidden_layer_sizes': 157, 'learning_rate_init': 0.024209588203294035, 'tol': 5.0229244698023884e-05, 'validation_fraction': 0.25145775245110913}
observation time 0.000014, current best 0.243130 at iter 5
suggestion time taken 28.097944 iter 6 next_points [{'alpha': 0.00014011563172284207, 'batch_size': 13, 'beta_1': 0.9790515568362254, 'beta_2': 0.9999971380760079, 'epsilon': 1.1855086155231255e-09, 'hidden_layer_sizes': 162, 'learning_rate_init': 2.5415186365140866e-05, 'tol': 0.005502821476808654, 'validation_fraction': 0.15114752198519926}]
function_evaluation time 30.396404 value 0.246756 suggestion {'alpha': 0.00014011563172284207, 'batch_size': 13, 'beta_1': 0.9790515568362254, 'beta_2': 0.9999971380760079, 'epsilon': 1.1855086155231255e-09, 'hidden_layer_sizes': 162, 'learning_rate_init': 2.5415186365140866e-05, 'tol': 0.005502821476808654, 'validation_fraction': 0.15114752198519926}
observation time 0.000013, current best 0.243130 at iter 6
suggestion time taken 26.740570 iter 7 next_points [{'alpha': 0.004179833718253513, 'batch_size': 21, 'beta_1': 0.9384963554814977, 'beta_2': 0.9993897717625239, 'epsilon': 8.141750626850868e-08, 'hidden_layer_sizes': 179, 'learning_rate_init': 0.00043775248139657334, 'tol': 5.2610564491072774e-05, 'validation_fraction': 0.2472158430676285}]
function_evaluation time 9.253838 value 0.113409 suggestion {'alpha': 0.004179833718253513, 'batch_size': 21, 'beta_1': 0.9384963554814977, 'beta_2': 0.9993897717625239, 'epsilon': 8.141750626850868e-08, 'hidden_layer_sizes': 179, 'learning_rate_init': 0.00043775248139657334, 'tol': 5.2610564491072774e-05, 'validation_fraction': 0.2472158430676285}
observation time 0.000014, current best 0.113409 at iter 7
suggestion time taken 26.207473 iter 8 next_points [{'alpha': 0.12743515774726225, 'batch_size': 25, 'beta_1': 0.9598344114099866, 'beta_2': 0.9999916510901394, 'epsilon': 7.632367767113768e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 0.015707156480235313, 'tol': 0.05412988648607951, 'validation_fraction': 0.1920868444676042}]
function_evaluation time 2.775949 value 0.131952 suggestion {'alpha': 0.12743515774726225, 'batch_size': 25, 'beta_1': 0.9598344114099866, 'beta_2': 0.9999916510901394, 'epsilon': 7.632367767113768e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 0.015707156480235313, 'tol': 0.05412988648607951, 'validation_fraction': 0.1920868444676042}
observation time 0.000002, current best 0.113409 at iter 8
suggestion time taken 28.139429 iter 9 next_points [{'alpha': 0.005232242001490968, 'batch_size': 11, 'beta_1': 0.962527541611816, 'beta_2': 0.9999750466184443, 'epsilon': 2.006826548686122e-08, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.03421575740912207, 'tol': 0.0019822424863747893, 'validation_fraction': 0.31595166571803524}]
function_evaluation time 5.173488 value 0.687247 suggestion {'alpha': 0.005232242001490968, 'batch_size': 11, 'beta_1': 0.962527541611816, 'beta_2': 0.9999750466184443, 'epsilon': 2.006826548686122e-08, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.03421575740912207, 'tol': 0.0019822424863747893, 'validation_fraction': 0.31595166571803524}
observation time 0.000012, current best 0.113409 at iter 9
suggestion time taken 26.543900 iter 10 next_points [{'alpha': 0.01817178337035612, 'batch_size': 24, 'beta_1': 0.8967513707656463, 'beta_2': 0.9972254158140463, 'epsilon': 6.9675527334771265e-09, 'hidden_layer_sizes': 106, 'learning_rate_init': 0.0025560809925339436, 'tol': 0.0028013552641928748, 'validation_fraction': 0.8911538337038405}]
function_evaluation time 1.445961 value 0.507059 suggestion {'alpha': 0.01817178337035612, 'batch_size': 24, 'beta_1': 0.8967513707656463, 'beta_2': 0.9972254158140463, 'epsilon': 6.9675527334771265e-09, 'hidden_layer_sizes': 106, 'learning_rate_init': 0.0025560809925339436, 'tol': 0.0028013552641928748, 'validation_fraction': 0.8911538337038405}
observation time 0.000002, current best 0.113409 at iter 10
suggestion time taken 26.491535 iter 11 next_points [{'alpha': 0.002165679496471242, 'batch_size': 13, 'beta_1': 0.9542782421231198, 'beta_2': 0.9999588049873201, 'epsilon': 1.901657205800245e-07, 'hidden_layer_sizes': 94, 'learning_rate_init': 0.0003004932334878167, 'tol': 1.3075663040261915e-05, 'validation_fraction': 0.5122696219081083}]
function_evaluation time 12.865196 value 0.172078 suggestion {'alpha': 0.002165679496471242, 'batch_size': 13, 'beta_1': 0.9542782421231198, 'beta_2': 0.9999588049873201, 'epsilon': 1.901657205800245e-07, 'hidden_layer_sizes': 94, 'learning_rate_init': 0.0003004932334878167, 'tol': 1.3075663040261915e-05, 'validation_fraction': 0.5122696219081083}
observation time 0.000014, current best 0.113409 at iter 11
suggestion time taken 26.635936 iter 12 next_points [{'alpha': 0.008219888408255825, 'batch_size': 12, 'beta_1': 0.9208760486978422, 'beta_2': 0.9980375152060782, 'epsilon': 2.6545543337774467e-07, 'hidden_layer_sizes': 125, 'learning_rate_init': 0.014895538657461571, 'tol': 1.0934863337498258e-05, 'validation_fraction': 0.7450601589419305}]
function_evaluation time 3.277215 value 0.284080 suggestion {'alpha': 0.008219888408255825, 'batch_size': 12, 'beta_1': 0.9208760486978422, 'beta_2': 0.9980375152060782, 'epsilon': 2.6545543337774467e-07, 'hidden_layer_sizes': 125, 'learning_rate_init': 0.014895538657461571, 'tol': 1.0934863337498258e-05, 'validation_fraction': 0.7450601589419305}
observation time 0.000007, current best 0.113409 at iter 12
suggestion time taken 25.752008 iter 13 next_points [{'alpha': 0.0026001543295195617, 'batch_size': 29, 'beta_1': 0.9824985022060614, 'beta_2': 0.9999860191879468, 'epsilon': 1.4488795762488179e-08, 'hidden_layer_sizes': 83, 'learning_rate_init': 0.004762135066975583, 'tol': 0.0011274389697225283, 'validation_fraction': 0.8528783676674107}]
function_evaluation time 1.314276 value 0.485678 suggestion {'alpha': 0.0026001543295195617, 'batch_size': 29, 'beta_1': 0.9824985022060614, 'beta_2': 0.9999860191879468, 'epsilon': 1.4488795762488179e-08, 'hidden_layer_sizes': 83, 'learning_rate_init': 0.004762135066975583, 'tol': 0.0011274389697225283, 'validation_fraction': 0.8528783676674107}
observation time 0.000003, current best 0.113409 at iter 13
suggestion time taken 27.478033 iter 14 next_points [{'alpha': 0.2801625602346232, 'batch_size': 14, 'beta_1': 0.9113474563225757, 'beta_2': 0.9999852033401921, 'epsilon': 4.708089550199864e-08, 'hidden_layer_sizes': 68, 'learning_rate_init': 0.00020596176294230946, 'tol': 1.4909302540423646e-05, 'validation_fraction': 0.8393671069440856}]
function_evaluation time 11.014612 value 0.496196 suggestion {'alpha': 0.2801625602346232, 'batch_size': 14, 'beta_1': 0.9113474563225757, 'beta_2': 0.9999852033401921, 'epsilon': 4.708089550199864e-08, 'hidden_layer_sizes': 68, 'learning_rate_init': 0.00020596176294230946, 'tol': 1.4909302540423646e-05, 'validation_fraction': 0.8393671069440856}
observation time 0.000008, current best 0.113409 at iter 14
saving meta data: {'args': {'--uuid': 'c524f73542ac5f13a0f28322494f641b', '-db-root': '/home/ryedida/smoothness-hpo/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/smoothness-hpo/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20240113_114336', '--opt': 'stcvx', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.25190216699945595])}
saving results
saving timing
saving suggest log
done
