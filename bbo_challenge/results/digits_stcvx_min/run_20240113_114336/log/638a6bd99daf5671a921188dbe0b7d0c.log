running: {'--uuid': '638a6bd99daf5671a921188dbe0b7d0c', '-db-root': '/home/ryedida/smoothness-hpo/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/smoothness-hpo/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20240113_114336', '--opt': 'stcvx', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python stcvx/optimizer.py -c MLP-adam -d digits -o stcvx -u 638a6bd99daf5671a921188dbe0b7d0c -m nll -n 15 -p 1 -dir /home/ryedida/smoothness-hpo/bbo_challenge_starter_kit/output -b run_20240113_114336
/home/ryedida/.local/lib/python3.8/site-packages/sklearn/neural_network/_multilayer_perceptron.py:603: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.8/site-packages/sklearn/neural_network/_multilayer_perceptron.py:684: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.25190216699945595])
/home/ryedida/.local/lib/python3.8/site-packages/bayesmark/experiment.py:469: UserWarning: Baselines not found. Will not log intermediate scores.
  warnings.warn("Baselines not found. Will not log intermediate scores.")

starting sklearn study stcvx MLP-adam digits nll 15 1
with data root: None
suggestion time taken 30.139602 iter 0 next_points [{'alpha': 1.5471629632074015, 'batch_size': 13, 'beta_1': 0.6907268113558211, 'beta_2': 0.99695489713955, 'epsilon': 7.576266223101073e-09, 'hidden_layer_sizes': 179, 'learning_rate_init': 0.0008278435146088638, 'tol': 0.00013453233901353855, 'validation_fraction': 0.8796112216940102}]
function_evaluation time 5.227883 value 0.332888 suggestion {'alpha': 1.5471629632074015, 'batch_size': 13, 'beta_1': 0.6907268113558211, 'beta_2': 0.99695489713955, 'epsilon': 7.576266223101073e-09, 'hidden_layer_sizes': 179, 'learning_rate_init': 0.0008278435146088638, 'tol': 0.00013453233901353855, 'validation_fraction': 0.8796112216940102}
observation time 0.000014, current best 0.332888 at iter 0
suggestion time taken 28.771603 iter 1 next_points [{'alpha': 0.009847562195552401, 'batch_size': 14, 'beta_1': 0.5502829261749977, 'beta_2': 0.9999653882961943, 'epsilon': 6.345392447182706e-07, 'hidden_layer_sizes': 165, 'learning_rate_init': 0.06165596493505811, 'tol': 0.0001509200434446299, 'validation_fraction': 0.18696131177635272}]
function_evaluation time 5.244582 value 1.363767 suggestion {'alpha': 0.009847562195552401, 'batch_size': 14, 'beta_1': 0.5502829261749977, 'beta_2': 0.9999653882961943, 'epsilon': 6.345392447182706e-07, 'hidden_layer_sizes': 165, 'learning_rate_init': 0.06165596493505811, 'tol': 0.0001509200434446299, 'validation_fraction': 0.18696131177635272}
observation time 0.000014, current best 0.332888 at iter 1
suggestion time taken 27.272866 iter 2 next_points [{'alpha': 4.187257631226107, 'batch_size': 23, 'beta_1': 0.8758128944750752, 'beta_2': 0.9949482768423682, 'epsilon': 2.0530736331719955e-08, 'hidden_layer_sizes': 177, 'learning_rate_init': 0.04000435598291448, 'tol': 1.2829134147242973e-05, 'validation_fraction': 0.8972973803571522}]
function_evaluation time 1.732662 value 0.638266 suggestion {'alpha': 4.187257631226107, 'batch_size': 23, 'beta_1': 0.8758128944750752, 'beta_2': 0.9949482768423682, 'epsilon': 2.0530736331719955e-08, 'hidden_layer_sizes': 177, 'learning_rate_init': 0.04000435598291448, 'tol': 1.2829134147242973e-05, 'validation_fraction': 0.8972973803571522}
observation time 0.000003, current best 0.332888 at iter 2
suggestion time taken 28.336647 iter 3 next_points [{'alpha': 1.0787216111224585, 'batch_size': 33, 'beta_1': 0.911270645497344, 'beta_2': 0.9989959592644122, 'epsilon': 2.6365710560230115e-07, 'hidden_layer_sizes': 68, 'learning_rate_init': 0.046727818151096806, 'tol': 0.00022797134793860915, 'validation_fraction': 0.520430801598804}]
function_evaluation time 2.157885 value 0.309108 suggestion {'alpha': 1.0787216111224585, 'batch_size': 33, 'beta_1': 0.911270645497344, 'beta_2': 0.9989959592644122, 'epsilon': 2.6365710560230115e-07, 'hidden_layer_sizes': 68, 'learning_rate_init': 0.046727818151096806, 'tol': 0.00022797134793860915, 'validation_fraction': 0.520430801598804}
observation time 0.000003, current best 0.309108 at iter 3
suggestion time taken 29.752574 iter 4 next_points [{'alpha': 8.26274547954952e-05, 'batch_size': 10, 'beta_1': 0.9142791474767827, 'beta_2': 0.9999926247718686, 'epsilon': 1.9949199562647785e-09, 'hidden_layer_sizes': 99, 'learning_rate_init': 0.0001284176030371971, 'tol': 0.0053967337033291075, 'validation_fraction': 0.6277823967545775}]
function_evaluation time 8.597116 value 0.330532 suggestion {'alpha': 8.26274547954952e-05, 'batch_size': 10, 'beta_1': 0.9142791474767827, 'beta_2': 0.9999926247718686, 'epsilon': 1.9949199562647785e-09, 'hidden_layer_sizes': 99, 'learning_rate_init': 0.0001284176030371971, 'tol': 0.0053967337033291075, 'validation_fraction': 0.6277823967545775}
observation time 0.000014, current best 0.309108 at iter 4
suggestion time taken 26.966459 iter 5 next_points [{'alpha': 0.033672099674467916, 'batch_size': 12, 'beta_1': 0.5122112211266472, 'beta_2': 0.9999988651591121, 'epsilon': 6.021525652235229e-07, 'hidden_layer_sizes': 88, 'learning_rate_init': 0.004137145339031943, 'tol': 1.4608138293493503e-05, 'validation_fraction': 0.5258722570426514}]
function_evaluation time 5.191884 value 0.150544 suggestion {'alpha': 0.033672099674467916, 'batch_size': 12, 'beta_1': 0.5122112211266472, 'beta_2': 0.9999988651591121, 'epsilon': 6.021525652235229e-07, 'hidden_layer_sizes': 88, 'learning_rate_init': 0.004137145339031943, 'tol': 1.4608138293493503e-05, 'validation_fraction': 0.5258722570426514}
observation time 0.000002, current best 0.150544 at iter 5
suggestion time taken 28.332597 iter 6 next_points [{'alpha': 0.10043782523778748, 'batch_size': 14, 'beta_1': 0.8444937133037855, 'beta_2': 0.9998654717135598, 'epsilon': 5.866612839527126e-09, 'hidden_layer_sizes': 55, 'learning_rate_init': 0.0002784017931816164, 'tol': 0.07833973047145572, 'validation_fraction': 0.7689963259563297}]
function_evaluation time 1.013869 value 1.588733 suggestion {'alpha': 0.10043782523778748, 'batch_size': 14, 'beta_1': 0.8444937133037855, 'beta_2': 0.9998654717135598, 'epsilon': 5.866612839527126e-09, 'hidden_layer_sizes': 55, 'learning_rate_init': 0.0002784017931816164, 'tol': 0.07833973047145572, 'validation_fraction': 0.7689963259563297}
observation time 0.000002, current best 0.150544 at iter 6
suggestion time taken 26.999154 iter 7 next_points [{'alpha': 1.864803211565009, 'batch_size': 10, 'beta_1': 0.9836304613428173, 'beta_2': 0.9999974206341691, 'epsilon': 2.2324051363645546e-07, 'hidden_layer_sizes': 96, 'learning_rate_init': 0.008095287588055975, 'tol': 0.004594488681331495, 'validation_fraction': 0.14625447458667612}]
function_evaluation time 7.147533 value 0.281999 suggestion {'alpha': 1.864803211565009, 'batch_size': 10, 'beta_1': 0.9836304613428173, 'beta_2': 0.9999974206341691, 'epsilon': 2.2324051363645546e-07, 'hidden_layer_sizes': 96, 'learning_rate_init': 0.008095287588055975, 'tol': 0.004594488681331495, 'validation_fraction': 0.14625447458667612}
observation time 0.000011, current best 0.150544 at iter 7
suggestion time taken 27.123322 iter 8 next_points [{'alpha': 0.5445939716791827, 'batch_size': 36, 'beta_1': 0.9867785816064422, 'beta_2': 0.9999783025972554, 'epsilon': 2.6148408299956786e-09, 'hidden_layer_sizes': 52, 'learning_rate_init': 0.027579553972122844, 'tol': 0.0024610455058760644, 'validation_fraction': 0.7935120122731426}]
function_evaluation time 1.730173 value 0.495928 suggestion {'alpha': 0.5445939716791827, 'batch_size': 36, 'beta_1': 0.9867785816064422, 'beta_2': 0.9999783025972554, 'epsilon': 2.6148408299956786e-09, 'hidden_layer_sizes': 52, 'learning_rate_init': 0.027579553972122844, 'tol': 0.0024610455058760644, 'validation_fraction': 0.7935120122731426}
observation time 0.000003, current best 0.150544 at iter 8
suggestion time taken 27.317672 iter 9 next_points [{'alpha': 0.00036381449723023703, 'batch_size': 12, 'beta_1': 0.5624415714162075, 'beta_2': 0.9790664280916764, 'epsilon': 7.767985571429034e-09, 'hidden_layer_sizes': 187, 'learning_rate_init': 2.268975396949775e-05, 'tol': 0.0011557209640398584, 'validation_fraction': 0.11701291041371945}]
function_evaluation time 25.354461 value 0.242547 suggestion {'alpha': 0.00036381449723023703, 'batch_size': 12, 'beta_1': 0.5624415714162075, 'beta_2': 0.9790664280916764, 'epsilon': 7.767985571429034e-09, 'hidden_layer_sizes': 187, 'learning_rate_init': 2.268975396949775e-05, 'tol': 0.0011557209640398584, 'validation_fraction': 0.11701291041371945}
observation time 0.000013, current best 0.150544 at iter 9
suggestion time taken 25.882838 iter 10 next_points [{'alpha': 0.004170297591956771, 'batch_size': 14, 'beta_1': 0.8836995907763459, 'beta_2': 0.9999988046824583, 'epsilon': 4.5216904267977226e-08, 'hidden_layer_sizes': 60, 'learning_rate_init': 0.00523868982134721, 'tol': 0.00017109804640552299, 'validation_fraction': 0.31062996425123496}]
function_evaluation time 5.273056 value 0.127650 suggestion {'alpha': 0.004170297591956771, 'batch_size': 14, 'beta_1': 0.8836995907763459, 'beta_2': 0.9999988046824583, 'epsilon': 4.5216904267977226e-08, 'hidden_layer_sizes': 60, 'learning_rate_init': 0.00523868982134721, 'tol': 0.00017109804640552299, 'validation_fraction': 0.31062996425123496}
observation time 0.000003, current best 0.127650 at iter 10
suggestion time taken 26.888858 iter 11 next_points [{'alpha': 0.008815836942904866, 'batch_size': 15, 'beta_1': 0.7413900831863754, 'beta_2': 0.9999484083625588, 'epsilon': 9.729308184788821e-09, 'hidden_layer_sizes': 100, 'learning_rate_init': 3.282279160009403e-05, 'tol': 0.08697310830461907, 'validation_fraction': 0.3068055423148187}]
function_evaluation time 2.911397 value 2.448725 suggestion {'alpha': 0.008815836942904866, 'batch_size': 15, 'beta_1': 0.7413900831863754, 'beta_2': 0.9999484083625588, 'epsilon': 9.729308184788821e-09, 'hidden_layer_sizes': 100, 'learning_rate_init': 3.282279160009403e-05, 'tol': 0.08697310830461907, 'validation_fraction': 0.3068055423148187}
observation time 0.000002, current best 0.127650 at iter 11
suggestion time taken 26.922213 iter 12 next_points [{'alpha': 5.9787486025292504e-05, 'batch_size': 29, 'beta_1': 0.980503524375383, 'beta_2': 0.9222991750103631, 'epsilon': 8.700869521842858e-09, 'hidden_layer_sizes': 51, 'learning_rate_init': 0.009507627935969983, 'tol': 0.0017663708609614228, 'validation_fraction': 0.8921654920526279}]
function_evaluation time 0.978836 value 1.505922 suggestion {'alpha': 5.9787486025292504e-05, 'batch_size': 29, 'beta_1': 0.980503524375383, 'beta_2': 0.9222991750103631, 'epsilon': 8.700869521842858e-09, 'hidden_layer_sizes': 51, 'learning_rate_init': 0.009507627935969983, 'tol': 0.0017663708609614228, 'validation_fraction': 0.8921654920526279}
observation time 0.000004, current best 0.127650 at iter 12
suggestion time taken 26.805377 iter 13 next_points [{'alpha': 0.019815929300859354, 'batch_size': 16, 'beta_1': 0.6565196376880066, 'beta_2': 0.9999973054683983, 'epsilon': 2.630757799532619e-08, 'hidden_layer_sizes': 145, 'learning_rate_init': 0.003728586973710747, 'tol': 0.0069488508583600735, 'validation_fraction': 0.6928291696735726}]
function_evaluation time 2.530325 value 0.183260 suggestion {'alpha': 0.019815929300859354, 'batch_size': 16, 'beta_1': 0.6565196376880066, 'beta_2': 0.9999973054683983, 'epsilon': 2.630757799532619e-08, 'hidden_layer_sizes': 145, 'learning_rate_init': 0.003728586973710747, 'tol': 0.0069488508583600735, 'validation_fraction': 0.6928291696735726}
observation time 0.000003, current best 0.127650 at iter 13
suggestion time taken 27.053710 iter 14 next_points [{'alpha': 7.558254454184174e-05, 'batch_size': 21, 'beta_1': 0.7463550386909575, 'beta_2': 0.99948633825659, 'epsilon': 2.515494806373639e-07, 'hidden_layer_sizes': 110, 'learning_rate_init': 0.04603752612324379, 'tol': 0.0014697528840855673, 'validation_fraction': 0.308059207636154}]
function_evaluation time 4.434431 value 0.379559 suggestion {'alpha': 7.558254454184174e-05, 'batch_size': 21, 'beta_1': 0.7463550386909575, 'beta_2': 0.99948633825659, 'epsilon': 2.515494806373639e-07, 'hidden_layer_sizes': 110, 'learning_rate_init': 0.04603752612324379, 'tol': 0.0014697528840855673, 'validation_fraction': 0.308059207636154}
observation time 0.000002, current best 0.127650 at iter 14
saving meta data: {'args': {'--uuid': '638a6bd99daf5671a921188dbe0b7d0c', '-db-root': '/home/ryedida/smoothness-hpo/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/smoothness-hpo/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20240113_114336', '--opt': 'stcvx', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.25190216699945595])}
saving results
saving timing
saving suggest log
done
